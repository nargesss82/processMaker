<?php

// دریافت شناسه کاربری مترجمی که در حال حاضر وارد سیستم شده است (کاربر لاگین‌شده)
$translatorid = @@USER_LOGGED;

// نمایش شناسه مترجم برای تست (Debug)
var_dump($translatorid);

// متغیر تست برای توقف اجرای کد و بررسی مقدار مترجم (در حال حاضر غیر فعال شده است)
// die();

// شناسه کاربر (user UID) برای ایجاد کیس جدید
// این مقدار در اینجا به صورت ثابت مشخص شده و معمولاً معرف کاربری خاص (مثلاً مدیر سیستم یا admin) است
$userUID = '00000000000000000000000000000001';

// آرایه‌ای از متغیرها برای انتقال اطلاعات به کیس جدید
$vars = array(
	// شناسه مترجم (مقدار گرفته‌شده از USER_LOGGED)
	'translatorId'         => $translatorid,
	
	// هزینه پیشنهادی مترجم (گرفته‌شده از متغیر فرم txt_cost)
	'cost'  => @@txt_cost,

	// زمان تحویل پیشنهادی مترجم (از متغیر فرم dat_time)
	'time'  => @@dat_time, 
	
	// شناسه کیس فعلی مربوط به پیشنهاد مترجم (همان کیس فعلی مترجم)
	'translator_case_id'     => @@APPLICATION,

	// نام فایل سفارش (مثلاً فایلی که مشتری برای ترجمه بارگذاری کرده)
	'file_name' => @@name,

	// نام کاربری مشتری (برای نمایش یا ارجاع در کیس جدید)
	'customer_username' => @@customerName,

	// شناسه کیس مشتری (برای ارجاع متقابل بین کیس‌ها)
	'customer_case_id' => @@customer_case_id,

	// شناسه کیس سفارش اصلی (جهت نگهداری ارتباط بین پیشنهاد و سفارش)
	'order_case_id' => @@order_case_id
);

// نمایش مقدار متغیرهای آماده‌شده جهت بررسی دقیق (Debug)
var_dump($vars);

// ایجاد یک کیس جدید با استفاده از تابع PMFNewCase
// پارامترها:
// 1. شناسه فرآیند مقصد (Process UID)
// 2. شناسه کاربری که مالک کیس جدید خواهد بود (اینجا userUID ثابت)
// 3. شناسه وظیفه (Task UID) که کیس باید از آن شروع شود
// 4. متغیرهایی که باید به کیس جدید انتقال داده شوند (آرایه $vars)
// 5. وضعیت شروع وظیفه (TO_DO یعنی در صف انجام)
$newCaseId = PMFNewCase(
	'759512857682f461f79a579054495571',  // Process UID
	$userUID,                            // User UID
	'4212499856840c05f12f420045984929',  // Task UID
	$vars,                               // Assigned Variables
	"TO_DO"                              // Task Status
);

// نمایش نتیجه ایجاد کیس جدید برای بررسی
var_dump("Case created for user $userUID: ", $newCaseId);

// می‌توان اینجا die() گذاشت تا اجرای کد متوقف شده و خروجی بررسی شود
// die();



